import Ajv, { JSONSchemaType } from 'ajv';

import type { IExploit } from '../interfaces/IExploit';

const ajv = new Ajv();

const EndpointSchema: JSONSchemaType<Array<IExploit>> = {
	type: 'array',
	items: {
		type: 'object',
		properties: {
			name: { type: 'string' },
			description: { type: 'string' },
			location: { type: 'string' },
			matches: {
				type: 'array',
				items: {
					type: 'string'
				}
			},
			version: { type: 'string' },
			uid: { type: 'string' }
		}
	}
};

const ExploitSchema: JSONSchemaType<IExploit> = {
	type: 'object',
	properties: {
		name: { type: 'string' },
		description: { type: 'string' },
		location: { type: 'string' },
		matches: {
			type: 'array',
			items: {
				type: 'string'
			}
		},
		version: { type: 'string' },
		uid: { type: 'string' }
	}
};

export const ValidateEndpoint = ajv.compile(EndpointSchema);
export const ValidateExploit = ajv.compile(ExploitSchema);
